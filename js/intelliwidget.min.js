!function(m){"use strict";function e(e){e.preventDefault(),e.stopPropagation();var t=W(m(e.target).attr("href"));return t.action="iw_add",w(e.target,t,i),!1}function i(e,t){var i=m(e).parent(".inside").find(".iw-profiles"),n=m(t.form).hide(),s=m(t.tab).hide();i.append(n),i.find(".iw-tabs").append(s),s.show(),i.tabs("refresh").tabs({active:s.index()}),b()}function s(e,t){window.IWAjax.debug,m(e).text(t)}function n(e){var t=m(e).parents(".iw-profile").first(),i=t.parent(".iw-profiles"),n=v(t.prop("id")),s=t.index();t.remove(),m("#iw_tab_"+n).remove(),i.tabs("refresh"),b(),i.tabs({active:s})}function u(e,t){m(e).html(t).prop("disabled",!1).multiSelect("refresh")}function a(e,t){window.IWAjax.debug&&console.log("in callbackMenus()"),window.IWAjax.debug&&console.log(e),m(e).html(t).find(".intelliwidget-multiselect").multiSelect()}function l(e,t){var i=m(t.tab),n=m(".iw-tabs").find("#"+i.prop("id")),s=m(e).parents(".iw-profile").first(),l=s.parent(".iw-profiles");n.html(i.html()),s.html(t.form).find(".intelliwidget-multiselect").multiSelect(),l.tabs("refresh").tabs({active:n.index()})}function t(e){if(m(e.target).hasClass("iw-menusearch")){if(clearTimeout(m(e.target).data("timer")),m(e.target).data("timer",setTimeout(j,400,e.target)),13===e.which)return e.stopPropagation(),e.preventDefault(),!1}else if(13===e.which)return e.stopPropagation(),e.preventDefault(),y(e.target),!1}function o(e){var t={};return t.intelliwidget_widget_page_id=m("#intelliwidget_widget_page_id").val(),t.action="iw_copy",w(e.target,t,null),!1}function r(e){e.preventDefault(),e.stopPropagation();var t=W(m(e.target).attr("href"));return t.action="iw_delete",w(e.target,t,n),!1}function d(e,t){var i="#"+m(e).attr("id");m(i).prop("disabled",!1),k(i,"hidden"),m(i).parents(".inside,.iw-profile").first().find(D).first().addClass(t)}function c(){window.IWAjax.debug&&console.log("in init()"),m(document).on("widget-updated",C),m(".iw-profiles").tabs(),m("body").on("click",".iw-collapsible > .iw-toggle, .iw-collapsible > h4, .iw-collapsible > h3",function(e){e.stopPropagation();var t=m(this).parent(".iw-collapsible"),i=m(this).parents("div.widget, div.iw-tabbed-section").first();t.hasClass("closed")?(t.removeClass("closed"),t.hasClass("panel-selection")&&function(e){window.IWAjax.debug&&console.log("in getMenus()");var t=O?".widget":".iw-profile",i=m(e.target).parents(t).first(),n=O?i.find(".widget-id").val():v(i.prop("id")),s=O?"#widget-"+n+"-menus":"#intelliwidget_"+n+"_menus",l={};if(m(s).has("select").length)return m(s).find(".intelliwidget-multiselect").multiSelect("refresh");O?(l["widget-id"]=i.find(".widget-id").val(),l.action="iw_widget_menus"):(m('input[type="hidden"]',i).each(function(){l[m(this).attr("id")]=m(this).val()}),l.action="iw_menus"),w(s,l,a)}(e)):t.addClass("closed"),S(i)}),m("body").on("change",".iw-sortby-menu",function(e){A(e.target)}),m(".iw-sortby-menu").each(function(e,t){A(t)}),m("#intelliwidget_main_meta_box,.main-meta-box").on("click",".iw-save",function(e){y(e.target)}),m("body").on("iwgallerysave",".intelliwidget-media",function(e){!function(e){m(e).parents("div.widget").length?U(e):y(e)}(e.target)}),m("#intelliwidget_post_meta_box").on("click",".iw-cdfsave",x),m("#intelliwidget_main_meta_box,.main-meta-box").on("click",".iw-copy",o),m("#intelliwidget_main_meta_box,.main-meta-box").on("click",".iw-add",e),m("#intelliwidget_main_meta_box,.main-meta-box").on("click",".iw-delete",r),m("#intelliwidget_main_meta_box,.main-meta-box").on("change",".iw-control",function(e){y(e.target)}),m("body").on("change",".intelliwidget-form-container .iw-widget-control",function(e){U(e.target)}),m("#intelliwidget_main_meta_box,.main-meta-box").on("keydown","input",t),m("body").on("keydown",".intelliwidget-form-container .iw-menusearch",function(e){if(13===e.which)return e.stopPropagation(),e.preventDefault(),j(e.target),!1;clearTimeout(m(e.target).data("timer")),m(e.target).data("timer",setTimeout(j,400,e.target))}),"post"===window.IWAjax.objtype&&(T("intelliwidget_event_date",!1),T("intelliwidget_expire_date",!1)),m("#intelliwidget_post_meta_box").on("click","a.intelliwidget-edit-timestamp",function(){var e=m(this).attr("id").split("-",1);return m("#"+e+"_div").is(":hidden")&&(m("#"+e+"_div").slideDown("fast"),m("#"+e+"_mm").focus(),m(this).hide()),!1}),m("#intelliwidget_post_meta_box").on("click",".intelliwidget-clear-timestamp",function(){var e=m(this).attr("id").split("-",1);return m("#"+e+"_div").slideUp("fast"),m("#"+e+"_mm").val(m("#"+e+"_cur_mm").val()),m("#"+e+"_jj").val(m("#"+e+"_cur_jj").val()),m("#"+e+"_aa").val(m("#"+e+"_cur_aa").val()),m("#"+e+"_hh").val(m("#"+e+"_cur_hh").val()),m("#"+e+"_mn").val(m("#"+e+"_cur_mn").val()),m("#"+e+"_timestamp").html(""),m("#"+e).val(""),m("a#"+e+"-edit").show(),T(e,!1),!1}),m("#intelliwidget_post_meta_box").on("click",".intelliwidget-cancel-timestamp",function(){var e=m(this).attr("id").split("-",1);return m("#"+e+"_div").slideUp("fast"),m("#"+e+"_mm").val(m("#"+e+"_hidden_mm").val()),m("#"+e+"_jj").val(m("#"+e+"_hidden_jj").val()),m("#"+e+"_aa").val(m("#"+e+"_hidden_aa").val()),m("#"+e+"_hh").val(m("#"+e+"_hidden_hh").val()),m("#"+e+"_mn").val(m("#"+e+"_hidden_mn").val()),m("a#"+e+"-edit").show(),T(e,!1),!1}),m("#intelliwidget_post_meta_box").on("click",".intelliwidget-save-timestamp",function(){var e=m(this).attr("id").split("-",1);return T(e,!0)&&(m("#"+e+"_div").slideUp("fast"),m("a#"+e+"-edit").show()),!1}),m(".iw-profiles").on("click",".iw-larr, .iw-rarr",function(e){e.preventDefault(),e.stopPropagation(),m(this).is(":visible")&&(m(this).hasClass("iw-larr")?function(e){var t,i=e.parent(".iw-profiles");1<i.data("visTabs").length&&(t=i.data("visTabs").pop())&&i.data("rightTabs").unshift(t);$(i)}(m(this)):function(e){var t,i=e.parent(".iw-profiles");(t=i.data("rightTabs").shift())&&i.data("visTabs").push(t);$(i)}(m(this)))}).on("click",".iw-tab-menu-toggle",f).on("click",".iw-tab-menu-item",_),m("#the-list").on("wpListAddEnd",h),h(),m(window).on("resize",p),m(".iw-profiles").slideDown(),b()}function p(){clearTimeout(z),z=setTimeout(function(){m(".iw-profiles").each(function(e,t){$(m(t))})},100)}function f(e){var t=m(".iw-tab-menu",e.target);t.hasClass("open")?t.stop().removeClass("open").fadeOut():t.stop().addClass("open").fadeIn()}function h(){m("#postcustomstuff").find("button.add_media").remove(),m("#postcustomstuff").find("textarea").each(function(e,t){!function(e){var t=e.id;m('<button type="button" id="insert_media_'+t+'" class="button insert-media add_media button-small" data-editor="'+t+'">Add Media</button>').insertBefore(e)}(t)})}function g(e){return("00"+e).slice(-2)}function v(e){var t=e.split("_"),i=t.pop();return t.pop()+"_"+i}function w(n,e,t){var i;(function(e){m(D).removeClass("success failure"),k(e,"visible"),m(e).prop("disabled",!0)}(n),O)?void 0!==window.wp.customize&&void 0!==window.wp.customize.Widgets?(e.nonce=window.wp.customize.Widgets.data.nonce,e.wp_customize="on"):e._wpnonce_widgets=m("#_wpnonce_widgets").val():(i=m("#"+window.IWAjax.idfield).length?m("#"+window.IWAjax.idfield).val():parseInt(m(n).attr("id").replace(/^intelliwidget_(\d+)_(\d+)/,"$1")),e[window.IWAjax.idfield]=i,e["iwpage_"+i]=m("#iwpage_"+i).val());return e.idfield=window.IWAjax.idfield,e.objtype=window.IWAjax.objtype,m.post(window.IWAjax.ajaxurl,e,function(e){"string"==typeof e&&e.match(/^fail/)?d(n,"failure"):(t&&t(n,e),d(n,"success"),O||m(document).trigger("widget-updated"))},"json").fail(function(e,t,i){d(n,"failure")}).always(function(){"iw_debug"!==e.action&&window.IWAjax.debug&&(window.IWAjax.debug&&console.log("in getDebug"),w("#debug_output",{action:"iw_debug"},s))}),!1}function b(s){m(".iw-profiles").each(function(e,t){var i=m(t),n=m(".iw-tab",i);void 0===s&&(s=n.length-1),i.data("leftTabs",[]),i.data("rightTabs",[]),i.data("visTabs",[]),n.each(function(e,t){s<e?i.data("rightTabs").push(t.id):i.data("visTabs").push(t.id)}),i.tabs({active:s}),$(i),function(e){var i=m("<ul>");m(".iw-tab",e).each(function(e,t){i.append('<li class="iw-tab-menu-item">'+m(t).text()+"</li>")}),m(".iw-tab-menu",e).html(i)}(i)})}function _(e){e.preventDefault(),e.stopPropagation(),b(m(e.target).index()),m(".iw-tab-menu-toggle").trigger("click")}function $(e){var t,i,n=m(".iw-tabs",e).width()-48,s=(e.data("visTabs").length,0),l=e.data("visTabs").slice();if(m(".iw-tab",e).hide(),n){for(;l.length;){if(i=l.pop(),n<s+(t=m("#"+i).show().outerWidth())){m("#"+i).hide(),l.push(i);break}s+=t}for(;e.data("rightTabs").length;){if(i=e.data("rightTabs").shift(),n<s+(t=m("#"+i).show().outerWidth())){m("#"+i).hide(),e.data("rightTabs").unshift(i);break}e.data("visTabs").push(i),s+=t}}e.data("leftTabs",l),function(e){m(".iw-larr, .iw-rarr",e).css("visibility","hidden"),e.data("rightTabs").length&&m(".iw-rarr",e).css("visibility","visible");e.data("leftTabs").length&&m(".iw-larr",e).css("visibility","visible")}(e)}function C(e,t){for(var i in I)I.hasOwnProperty(i)&&1===I[i]&&(m("#"+i).parent(".iw-collapsible").removeClass("closed"),t&&m("#"+i).find(".intelliwidget-multiselect").multiSelect())}function x(e){var t={};m(".intelliwidget-input").each(function(){t[m(this).attr("id")]="checkbox"===m(this).attr("type")?m(this).is(":checked")?1:0:m(this).val()}),t.action="iw_cdfsave",w(e.target,t,null)}function y(e){var t=m(e).parents(".iw-profile").first(),i=t.find(".iw-save"),n=v(t.prop("id")),s={};return S(t),s["intelliwidget_"+n+"_post_types"]=[],t.find("select,textarea,input[type=text],input[type=checkbox]:checked,input[type=hidden]").each(function(){var e=m(this),t=e.prop("id"),i=e.val();0<t.indexOf("_post_types")?s["intelliwidget_"+n+"_post_types"].push(i):s[t]=i,0<t.indexOf("_menu_location")&&""!==i&&(s["intelliwidget_"+n+"_replace_widget"]="nav_menu_location-"+i)}),s.action="iw_save",w(i,s,l),!1}function U(e){var t=m(e).parents("div.widget").first(),i=t.find(".widget-id").val();if(void 0!==window.wp.customize&&void 0!==window.wp.customize.Widgets){var n=window.wp.customize.Widgets.getWidgetFormControlForWidget(i);n.liveUpdateMode=!1,n.updateWidget()}else S(t),window.wpWidgets.save(t,0,0,0)}function j(e){var t,i=m(e).val(),n=O?".widget":".iw-profile",s=m(e).parents(n).first(),l=m(e).attr("id"),a=l.substring(0,l.indexOf("search")),o=a.split(/[\-_]/),r=o.pop(),d=o.pop(),c=[],p={};p[l]=i.replace(/[\n\r]/g,""),p[a]=m("#"+a).val(),p.menutype=r,O?(p["widget-id"]="intelliwidget-"+d,p.action="iw_widget_menu"):(m('input[name*="post_types"][type="hidden"]',s).each(function(){c.push(m(this).val())}),c.length&&(p.post_types=c),(t=m('input[name*="site_id"][type="hidden"]',s))&&t.length&&(p.site_id=t.val()),p.intelliwidget_box_id=d,p.action="iw_menu"),w("#"+a,p,u)}function k(e,t){var i;(i=m(e).hasClass("iw-save")?m(e).parent(".iw-save-container").siblings(".spinner").first():m(e).hasClass("iw-delete")?m(e).parent(".submitbox").siblings(".spinner").first():m(e).hasClass("iw-toggle iw-collapsible")?m(e).parent(".").siblings(".spinner").first():m(e).parents(".inside").first().find(".spinner").first()).css({visibility:t}).show(),"hidden"===t&&i.hide()}function A(e){-1!==m.inArray(m(e).val(),["selection","rand"])?m(e).siblings(".iw-sortorder-menu").hide():m(e).siblings(".iw-sortorder-menu").show()}function S(e){e.find(".inside").each(function(){var e=m(this).prop("id");I[e]=m(this).parent(".iw-collapsible").hasClass("closed")?0:1})}function T(e,t){var i="#"+e+"_div",n=!t&&!m("#"+e).val(),s=m("#"+e+"_aa").val(),l=g(m("#"+e+"_mm").val()),a=g(m("#"+e+"_jj").val()),o=g(m("#"+e+"_hh").val()),r=g(m("#"+e+"_mn").val()),d=new Date(s,l-1,a,o,r),c=d.getFullYear().toString(),p=g(1+d.getMonth()),u=g(d.getDate()),f=g(d.getHours()),h=g(d.getMinutes());if(!m(i).length)return!0;if(c!==s||p!==l||u!==a||f!==o||h!==r){if(!0===t)return m(i).addClass("form-invalid"),m(".iw-cdfsave").prop("disabled",!0),!1;n=!0}return m(i).removeClass("form-invalid"),m(".iw-cdfsave").prop("disabled",!1),n?m("#"+e).val(""):(m("#"+e+"_timestamp").html("<b>"+m('option[value="'+m("#"+e+"_mm").val()+'"]',"#"+e+"_mm").text()+" "+a+", "+s+" @ "+o+":"+r+"</b> "),m("#"+e).val(s+"-"+m("#"+e+"_mm").val()+"-"+a+" "+o+":"+r)),!0}function W(e){var t,i,n={},s=e.substring(e.indexOf("?")+1).split("&");for(i=0;i<s.length;i++)t=s[i].split("="),n[decodeURIComponent(t[0])]=decodeURIComponent(t[1]);return n}var I={},D=".iw-copy-container,.iw-save-container,.iw-cdf-container",O="widget"===window.IWAjax.objtype,z=1;m(document).ready(function(){window.IWAjax.debug&&console.log("document ready()"),c()})}(jQuery),window.intelliwidgetpro_preview_width=50,window.intelliwidgetpro_update_preview_width=function(e){"use strict";window.intelliwidgetpro_preview_width=e,window.IWAjax.debug&&console.log("width from iframe : "+e)},function(b){"use strict";function l(e,t){this.options=t,this.$element=b(e),this.$container=b("<div/>",{class:"ms-container"}),this.$selectableContainer=b("<div/>",{class:"ms-selectable"}),this.$selectionContainer=b("<div/>",{class:"ms-selection"}),this.$selectableUl=b("<ul/>",{class:"ms-list",tabindex:"-1"}),this.$selectionUl=b("<ul/>",{class:"ms-list",tabindex:"-1"}),this.scrollTo=0,this.elemsSelector="li:visible:not( .ms-optgroup-label,.ms-optgroup-container,."+t.disabledClass+" )"}l.prototype={constructor:l,init:function(){var e=this,t=this.$element;if(0===t.next(".ms-container").length){t.css({position:"absolute",left:"-9999px"}),t.attr("id",t.attr("id")?t.attr("id"):Math.ceil(1e3*Math.random())+"multiselect"),this.$container.attr("id","ms-"+t.attr("id")),this.$container.addClass(e.options.cssClass),t.find("option").each(function(){e.generateLisFromOption(this)}),this.$selectionUl.find(".ms-optgroup-label").hide(),e.options.selectableHeader&&e.$selectableContainer.append(e.options.selectableHeader),e.$selectableContainer.append(e.$selectableUl),e.options.selectableFooter&&e.$selectableContainer.append(e.options.selectableFooter),e.options.selectionHeader&&e.$selectionContainer.append(e.options.selectionHeader),e.$selectionContainer.append(e.$selectionUl),e.options.selectionFooter&&e.$selectionContainer.append(e.options.selectionFooter),e.$container.append(e.$selectableContainer),e.$container.append(e.$selectionContainer),t.after(e.$container),e.activeMouse(e.$selectableUl),e.activeKeyboard(e.$selectableUl);var i=e.options.dblClick?"dblclick":"click";e.$selectableUl.on(i,".ms-elem-selectable",function(){e.select(b(this).data("ms-value"))}),e.$selectionUl.on(i,".ms-elem-selection",function(){e.deselect(b(this).data("ms-value"))}),e.activeMouse(e.$selectionUl),e.activeKeyboard(e.$selectionUl),t.on("focus",function(){e.$selectableUl.focus()})}var n=t.find("option:selected").map(function(){return b(this).val()}).get();e.select(n,"init"),"function"==typeof e.options.afterInit&&e.options.afterInit.call(this,this.$container)},generateLisFromOption:function(e,t){for(var i=this,n=i.$element,s="",l=b(e),a=0;a<e.attributes.length;a++){var o=e.attributes[a];"value"!==o.name&&"disabled"!==o.name&&(s+=o.name+'="'+o.value+'" ')}var r=b("<li "+s+"><span>"+i.escapeHTML(l.text())+"</span></li>"),d=r.clone(),c=l.val(),p=i.sanitize(c);r.data("ms-value",c).addClass("ms-elem-selectable").attr("id",p+"-selectable"),d.data("ms-value",c).addClass("ms-elem-selection").attr("id",p+"-selection").hide(),(l.prop("disabled")||n.prop("disabled"))&&(d.addClass(i.options.disabledClass),r.addClass(i.options.disabledClass));var u=l.parent("optgroup");if(0<u.length){var f=u.attr("label"),h=i.sanitize(f),m=i.$selectableUl.find("#optgroup-selectable-"+h),g=i.$selectionUl.find("#optgroup-selection-"+h);if(0===m.length){var v='<li class="ms-optgroup-container"></li>',w='<ul class="ms-optgroup"><li class="ms-optgroup-label"><span>'+f+"</span></li></ul>";m=b(v),g=b(v),m.attr("id","optgroup-selectable-"+h),g.attr("id","optgroup-selection-"+h),m.append(b(w)),g.append(b(w)),i.options.selectableOptgroup&&(m.find(".ms-optgroup-label").on("click",function(){var e=u.children(":not(:selected, :disabled )").map(function(){return b(this).val()}).get();i.select(e)}),g.find(".ms-optgroup-label").on("click",function(){var e=u.children(":selected:not(:disabled )").map(function(){return b(this).val()}).get();i.deselect(e)})),i.$selectableUl.append(m),i.$selectionUl.append(g)}t=void 0===t?m.find("ul").children().length:t+1,r.insertAt(t,m.children()),d.insertAt(t,g.children())}else t=void 0===t?i.$selectableUl.children().length:t,r.insertAt(t,i.$selectableUl),d.insertAt(t,i.$selectionUl)},addOption:function(e){var l=this;void 0!==e.value&&null!==e.value&&(e=[e]),b.each(e,function(e,t){if(void 0!==t.value&&null!==t.value&&0===l.$element.find("option[value='"+t.value+"']").length){var i=b('<option value="'+t.value+'">'+t.text+"</option>"),n=parseInt(void 0===t.index?l.$element.children().length:t.index),s=void 0===t.nested?l.$element:b("optgroup[label='"+t.nested+"']");i.insertAt(n,s),l.generateLisFromOption(i.get(0),n,t.nested)}})},escapeHTML:function(e){return b("<div>").text(e).html()},activeKeyboard:function(i){var n=this;i.on("focus",function(){b(this).addClass("ms-focus")}).on("blur",function(){b(this).removeClass("ms-focus")}).on("keydown",function(e){switch(e.which){case 40:case 38:return e.preventDefault(),e.stopPropagation(),void n.moveHighlight(b(this),38===e.which?-1:1);case 37:case 39:return e.preventDefault(),e.stopPropagation(),void n.switchList(i);case 9:if(n.$element.is("[tabindex]")){e.preventDefault();var t=parseInt(n.$element.attr("tabindex"),10);return t=e.shiftKey?t-1:t+1,void b('[tabindex="'+t+'"]').focus()}e.shiftKey&&n.$element.trigger("focus")}if(-1<b.inArray(e.which,n.options.keySelect))return e.preventDefault(),e.stopPropagation(),void n.selectHighlighted(i)})},moveHighlight:function(e,t){var i,n,s,l=e.find(this.elemsSelector),a=l.filter(".ms-hover"),o=null,r=l.first().outerHeight(),d=e.height();if(l.removeClass("ms-hover"),1===t?0===(o=a.nextAll(this.elemsSelector).first()).length&&(o=(i=a.parent()).hasClass("ms-optgroup")&&0<(n=i.parent().next(":visible")).length?n.find(this.elemsSelector).first():l.first()):-1===t&&0===(o=a.prevAll(this.elemsSelector).first()).length&&(o=(i=a.parent()).hasClass("ms-optgroup")&&0<(s=i.parent().prev(":visible")).length?s.find(this.elemsSelector).last():l.last()),0<o.length){o.addClass("ms-hover");var c=e.scrollTop()+o.position().top-d/2+r/2;e.scrollTop(c)}},selectHighlighted:function(e){var t=e.find(this.elemsSelector),i=t.filter(".ms-hover").first();0<i.length&&(e.parent().hasClass("ms-selectable")?this.select(i.data("ms-value")):this.deselect(i.data("ms-value")),t.removeClass("ms-hover"))},switchList:function(e){e.blur(),this.$container.find(this.elemsSelector).removeClass("ms-hover"),e.parent().hasClass("ms-selectable")?this.$selectionUl.focus():this.$selectableUl.focus()},activeMouse:function(){var e=this;b("body").on("mouseenter",e.elemsSelector,function(){b(this).parents(".ms-container").find(e.elemsSelector).removeClass("ms-hover"),b(this).addClass("ms-hover")}),b("body").on("mouseleave",e.elemsSelector,function(){b(this).parents(".ms-container").find(e.elemsSelector).removeClass("ms-hover")})},refresh:function(){this.destroy(),this.$element.multiSelect(this.options)},destroy:function(){b("#ms-"+this.$element.attr("id")).remove(),this.$element.css("position","").css("left",""),this.$element.removeData("multiselect")},select:function(e,t){"string"==typeof e&&(e=[e]);var i=this,n=this.$element,s=b.map(e,function(e){return i.sanitize(e)}),l=this.$selectableUl.find("#"+s.join("-selectable, #")+"-selectable").filter(":not(."+i.options.disabledClass+")"),a=this.$selectionUl.find("#"+s.join("-selection, #")+"-selection").filter(":not(."+i.options.disabledClass+")"),o=n.find("option:not(:disabled )").filter(function(){return-1<b.inArray(this.value,e)});if("init"===t&&(l=this.$selectableUl.find("#"+s.join("-selectable, #")+"-selectable"),a=this.$selectionUl.find("#"+s.join("-selection, #")+"-selection")),0<l.length){l.addClass("ms-selected").hide(),a.addClass("ms-selected").show(),o.prop("selected",!0),i.$container.find(i.elemsSelector).removeClass("ms-hover");var r=i.$selectableUl.children(".ms-optgroup-container");if(0<r.length)r.each(function(){var e=b(this).find(".ms-elem-selectable");e.length===e.filter(".ms-selected").length&&b(this).find(".ms-optgroup-label").hide()}),i.$selectionUl.children(".ms-optgroup-container").each(function(){0<b(this).find(".ms-elem-selection").filter(".ms-selected").length&&b(this).find(".ms-optgroup-label").show()});else if(i.options.keepOrder&&"init"!==t){var d=i.$selectionUl.find(".ms-selected");1<d.length&&d.last().get(0)!==a.get(0)&&a.insertAfter(d.last())}"init"!==t&&(n.trigger("change"),"function"==typeof i.options.afterSelect&&i.options.afterSelect.call(this,e))}},deselect:function(e){"string"==typeof e&&(e=[e]);var t=this,i=this.$element,n=b.map(e,function(e){return t.sanitize(e)}),s=this.$selectableUl.find("#"+n.join("-selectable, #")+"-selectable"),l=this.$selectionUl.find("#"+n.join("-selection, #")+"-selection").filter(".ms-selected").filter(":not( ."+t.options.disabledClass+" )"),a=i.find("option").filter(function(){return-1<b.inArray(this.value,e)});if(0<l.length){s.removeClass("ms-selected").show(),l.removeClass("ms-selected").hide(),a.prop("selected",!1),t.$container.find(t.elemsSelector).removeClass("ms-hover");var o=t.$selectableUl.children(".ms-optgroup-container");if(0<o.length)o.each(function(){0<b(this).find(".ms-elem-selectable").filter(":not( .ms-selected )").length&&b(this).find(".ms-optgroup-label").show()}),t.$selectionUl.children(".ms-optgroup-container").each(function(){0===b(this).find(".ms-elem-selection").filter(".ms-selected").length&&b(this).find(".ms-optgroup-label").hide()});i.trigger("change"),"function"==typeof t.options.afterDeselect&&t.options.afterDeselect.call(this,e)}},select_all:function(){var e=this.$element,t=e.val();if(e.find('option:not( ":disabled" )').prop("selected",!0),this.$selectableUl.find(".ms-elem-selectable").filter(":not( ."+this.options.disabledClass+" )").addClass("ms-selected").hide(),this.$selectionUl.find(".ms-optgroup-label").show(),this.$selectableUl.find(".ms-optgroup-label").hide(),this.$selectionUl.find(".ms-elem-selection").filter(":not( ."+this.options.disabledClass+" )").addClass("ms-selected").show(),this.$selectionUl.focus(),e.trigger("change"),"function"==typeof this.options.afterSelect){var i=b.grep(e.val(),function(e){return b.inArray(e,t)<0});this.options.afterSelect.call(this,i)}},deselect_all:function(){var e=this.$element,t=e.val();e.find("option").prop("selected",!1),this.$selectableUl.find(".ms-elem-selectable").removeClass("ms-selected").show(),this.$selectionUl.find(".ms-optgroup-label").hide(),this.$selectableUl.find(".ms-optgroup-label").show(),this.$selectionUl.find(".ms-elem-selection").removeClass("ms-selected").hide(),this.$selectableUl.focus(),e.trigger("change"),"function"==typeof this.options.afterDeselect&&this.options.afterDeselect.call(this,t)},sanitize:function(e){var t,i=0;if(0===e.length)return i;var n;for(t=0,n=e.length;t<n;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i}},b.fn.multiSelect=function(){var n=arguments[0],s=arguments;return this.each(function(){var e=b(this),t=e.data("multiselect"),i=b.extend({},b.fn.multiSelect.defaults,e.data(),"object"==typeof n&&n);t||e.data("multiselect",t=new l(this,i)),"string"==typeof n?t[n](s[1]):t.init()})},b.fn.multiSelect.defaults={keySelect:[32],selectableOptgroup:!1,disabledClass:"disabled",dblClick:!1,keepOrder:!1,cssClass:""},b.fn.multiSelect.Constructor=l,b.fn.insertAt=function(e,t){return this.each(function(){0===e?t.prepend(this):t.children().eq(e-1).after(this)})}}(window.jQuery);